---
import { getCollection } from 'astro:content';

import ServiceFeat from '@components/services/Service.astro';

const services = (await getCollection('services')).sort(
  (a, b) => a.data.order - b.data.order
);
---

<section class="w-full flex flex-col justify-center my-8 lg:my-16">
  {services.map(({ slug }, idx) => <ServiceFeat id={slug} idx={idx} />)}
</section>

<style is:global lang="scss">
  .modal-service {
    max-width: unset !important;
    padding-inline: 1.5rem !important;

    button[data-id='close'] {
      position: absolute !important;
      top: 1rem !important;
      right: 1rem !important;
    }

    strong {
      font-family: 'AlexBrush', cursive !important;
      font-size: 1.65rem !important;
      margin-top: 1.5rem !important;
      margin-bottom: 0.5rem !important;
    }

    @media (min-width: 640px) {
      strong {
        font-size: 1.75rem !important;
      }
    }

    @media (min-width: 1024px) {
      strong {
        font-size: 1.85rem !important;
      }
    }

    @media (min-width: 1280px) {
      strong {
        font-size: 2rem !important;
      }
    }

    @media (min-width: 1536px) {
      width: fit-content;

      strong {
        font-size: 2.25rem !important;
      }
    }

    @media (min-width: 1920px) {
      width: fit-content;

      strong {
        font-size: 2.5rem !important;
      }
    }

    .modal-content {
      max-height: 70vh;
      overflow-y: auto;
    }
  }
</style>

<script>
  import { modal } from 'webcoreui';

  document.addEventListener('astro:page-load', () => {
    document.querySelectorAll('[data-slug]').forEach((el) => {
      const slug = el.getAttribute('data-slug');
      modal({
        trigger: `.trigger-${slug}`,
        modal: `.modal-${slug}`,
        onOpen: () => {
          console.log(`Modal for service ${slug} opened`);
        },
      });
    });
  });
</script>
